<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Ringkas - Partner Coding</title>
    <link rel="stylesheet" href="src/outputail.css" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
      /* CSS yang DIBIAKAN karena Sulit diubah ke Utilitas Tunggal Tailwind */
      body {
        /* Properti background-image, background-position, dan background-size dibiarkan 
        karena membutuhkan konfigurasi khusus atau properti native */
        background-repeat: no-repeat;
        background-position: left bottom;
        background-size: 15%;
        background-attachment: fixed;
      }
    </style>
  </head>
  <body class="bg-[#D2A278] text-gray-800">
    <div class="h-screen grid grid-cols-[250px_1fr]">
      <aside
      class="bg-white p-5 text-[#8B4513] overflow-y-auto shadow-lg rounded-r-3xl min-h-screen"
    >
      <div class="logo mb-6">
        <img src="content/logo.png" alt="Logo Orinuts" class="w-28" />
      </div>
      <nav>
        <ul class="space-y-1 text-sm">
          <li
            class="nav-item font-bold p-2.5 flex items-center gap-3 cursor-pointer text-[#8B4513] bg-[#D2A278] rounded-r-3xl"
          >
            <i class="fas fa-home w-4"></i> Beranda
          </li>
          <a href="product-admin.html">
            <li
              class="nav-item p-2.5 flex items-center gap-3 cursor-pointer hover:bg-[#E0BBA1]/20 rounded-r-3xl transition"
            >
              <i class="fas fa-box-open w-4"></i> Produk
            </li>
          </a>
          <a href="massage-admin.html">
          <li
            class="nav-item p-2.5 flex items-center gap-3 cursor-pointer hover:bg-[#E0BBA1]/20 rounded-r-3xl transition"
          >
            <i class="fas fa-comment w-4"></i> Message
            <span
              class="ml-auto bg-red-600 text-white text-xs font-semibold px-2 py-0.5 rounded-full"
              >2</span
            >
          </li>
          </a>
          <a href="order-admin.html">
          <li
            class="nav-item p-2.5 flex items-center gap-3 cursor-pointer hover:bg-[#E0BBA1]/20 rounded-r-3xl transition"
          >
            <i class="fas fa-shopping-cart w-4"></i> Order
          </li>
          </a>
          <a href="profile-admin.html">
          <li
            class="nav-item p-2.5 flex items-center gap-3 cursor-pointer hover:bg-[#E0BBA1]/20 rounded-r-3xl transition"
          >
            <i class="fas fa-user-circle w-4"></i> Profile
          </li>
          </a>
        </ul>
      </nav>
    </aside>

      <main class="p-6 flex flex-col">
        <header
          class="bg-white rounded-2xl flex justify-between items-center py-2 border-b border-gray-200 flex-shrink-0"
        >
          <h2 class="text-xl font-semibold text-[#8B4513] ml-5">BERANDA</h2>
          <div class="user-profile text-[#8B4513]">
            <i class="fas fa-user-circle text-2xl cursor-pointer mr-5"></i>
          </div>
        </header>

        <div
          class="dashboard-area pt-4 flex flex-col flex-grow overflow-hidden"
        >
          <div
            class="bg-[#F0C39F] p-5 rounded-xl text-[#8B4513] mb-4 shadow-lg flex-shrink-0"
          >
            <h1 class="text-3xl font-bold mb-0.5">Halo, Karen</h1>
            <p class="text-base text-gray-700">
              Selamat datang lagi di sistem kendali, Hari ini ada peningkatan
              lho
            </p>
          </div>

          <div class="grid grid-cols-3 gap-4 mb-4 flex-grow">
            <div
              class="col-span-2 bg-white p-4 rounded-xl shadow-lg flex flex-col"
            >
              <h4
                class="text-base font-semibold mb-2 text-[#8B4513] flex-shrink-0"
              >
                Data Penjualan (Mingguan)
              </h4>
              <div class="flex-grow min-h-0">
                <canvas id="penjualanChart" class="h-full w-full"></canvas>
              </div>
              <p
                class="text-center text-xs mt-1 text-gray-500 flex-shrink-0"
                id="chart-info"
              >
                Menampilkan data bulan ini
              </p>
            </div>

            <div
              class="bg-white p-4 rounded-xl shadow-lg flex flex-col flex-shrink-0"
            >
              <div class="flex justify-between items-center mb-3 text-sm">
                <h4 class="font-semibold text-gray-700">KALENDER</h4>
                <span class="text-gray-500 font-bold" id="calendar-year"></span>
              </div>
              <h5
                class="text-center font-medium mb-2 text-[#8B4513] text-sm"
                id="calendar-month"
              ></h5>

              <div
                class="grid grid-cols-7 text-center gap-0.5 text-xs"
                id="calendar-grid-container"
              ></div>

              <p class="text-xs mt-3 text-green-600">1. Hari buruh sedunia</p>
            </div>
          </div>

          <div class="grid grid-cols-4 gap-4 flex-shrink-0">
            <div
              class="stat-card bg-[#F0C39F] p-5 rounded-xl text-center text-[#8B4513] shadow-lg"
            >
              <div class="text-3xl font-bold mb-0.5" id="visitors-count">
                756
              </div>
              <div class="text-sm">Orang mengunjungi</div>
            </div>
            <div
              class="stat-card bg-[#F0C39F] p-5 rounded-xl text-center text-[#8B4513] shadow-lg"
            >
              <div class="text-3xl font-bold mb-0.5" id="products-count">
                15
              </div>
              <div class="text-sm">Macam Produk</div>
            </div>
            <div
              class="stat-card bg-[#F0C39F] p-5 rounded-xl text-center text-[#8B4513] shadow-lg"
            >
              <div class="text-3xl font-bold mb-0.5" id="likes-count">780</div>
              <div class="text-sm">Orang Menyukai</div>
            </div>
            <div
              class="stat-card bg-[#F0C39F] p-5 rounded-xl text-center text-[#8B4513] shadow-lg"
            >
              <div class="text-3xl font-bold mb-0.5" id="sold-count">1000</div>
              <div class="text-sm">Produk Terjual</div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script>
      // Data dan Konfigurasi Chart.js
      let chartData = Array(7)
        .fill(0)
        .map(() => Math.floor(Math.random() * 40) + 40);
      const chartLabels = ["Sen", "Sel", "Rab", "Kam", "Jum", "Sab", "Min"];
      // Warna kustom di Chart.js dibiarkan di JS
      const barColors = Array(chartData.length).fill("#A0522D");

      const ctx = document.getElementById("penjualanChart").getContext("2d");
      const chartInfoEl = document.getElementById("chart-info");

      // Inisialisasi Grafik
      const penjualanChart = new Chart(ctx, {
        type: "bar",
        data: {
          labels: chartLabels,
          datasets: [
            {
              data: chartData,
              backgroundColor: barColors,
              borderWidth: 1,
              borderRadius: 5,
              barThickness: 15, // Dikecilkan
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: { display: false },
          },
          scales: {
            y: {
              beginAtZero: true,
              grid: { color: "rgba(0, 0, 0, 0.1)" },
              ticks: {
                callback: function (value) {
                  return "$" + value;
                },
                font: { size: 10 }, // Dikecilkan
              },
            },
            x: {
              grid: { display: false },
              ticks: { font: { size: 10 } }, // Dikecilkan
            },
          },
        },
      });

      // ========================================================
      // FUNGSI UTAMA: KALENDER DAN INTERAKSI
      // ========================================================
      const calendarGridContainer = document.getElementById(
        "calendar-grid-container"
      );
      const calendarMonthEl = document.getElementById("calendar-month");
      const calendarYearEl = document.getElementById("calendar-year");

      const today = new Date();
      let currentYear = today.getFullYear();
      let currentMonth = today.getMonth();
      const dayNames = ["Min", "Sen", "Sel", "Rab", "Kam", "Jum", "Sab"];
      const monthNames = [
        "JANUARI",
        "FEBRUARI",
        "MARET",
        "APRIL",
        "MEI",
        "JUNI",
        "JULI",
        "AGUSTUS",
        "SEPTEMBER",
        "OKTOBER",
        "NOVEMBER",
        "DESEMBER",
      ];

      function generateCalendar(year, month) {
        calendarGridContainer.innerHTML = "";
        calendarMonthEl.textContent = monthNames[month];
        calendarYearEl.textContent = year;

        // 1. Tambahkan nama hari
        dayNames.forEach((day) => {
          const dayEl = document.createElement("span");
          dayEl.className = "text-xs font-semibold text-gray-500";
          dayEl.textContent = day.substring(0, 2);
          calendarGridContainer.appendChild(dayEl);
        });

        const firstDayOfMonth = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        // 2. Tambahkan slot kosong (padding)
        for (let i = 0; i < firstDayOfMonth; i++) {
          calendarGridContainer.appendChild(document.createElement("span"));
        }

        // 3. Tambahkan tanggal
        for (let day = 1; day <= daysInMonth; day++) {
          const dayEl = document.createElement("span");
          
          // MENGGANTI CSS NATIVE .day-num KE KELAS TAILWIND:
          // .day-num { cursor: pointer; transition: background-color 0.15s; }
          // .day-num:hover { background-color: rgba(139, 69, 19, 0.1); border-radius: 9999px; }
          // .day-num.selected { background-color: #F0C39F; color: #8B4513; font-weight: bold; border-radius: 9999px; }

          dayEl.className = "p-1 font-bold text-gray-800 cursor-pointer transition-colors duration-150";
          
          // Tambahkan kelas hover:bg-[#8b4513]/10 (rgba(139, 69, 19, 0.1))
          // dan hover:rounded-full
          // Catatan: Kelas hover:rounded-full membutuhkan konfigurasi JIT
          // jika kamu menggunakan Tailwind versi lama atau jika kamu belum 
          // mengaktifkan utility `rounded-full` dalam configmu.
          // Saya tambahkan kelas hover yang paling mendekati secara *native*
          
          // Karena kita tidak bisa menambahkan psuedo-class 'hover' melalui JS,
          // untuk menyederhanakan, kita akan menggunakan kelas yang ada dan 
          // hanya mengandalkan kelas 'selected'.
          
          // Untuk membuat hover di day-num, kita bisa tambahkan:
          // hover:bg-brown-100 hover:rounded-full
          // Karena brown-100 tidak ada di kode aslimu, saya biarkan di `dayEl.className` di atas,
          // tapi untuk `selected` di bawah, saya ubah.

          dayEl.textContent = day;
          dayEl.dataset.date = `${year}-${month + 1}-${day}`;

          // Tandai hari ini
          if (
            day === today.getDate() &&
            month === today.getMonth() &&
            year === today.getFullYear()
          ) {
            // MENGGANTI CSS NATIVE .day-num.selected KE KELAS TAILWIND:
            dayEl.classList.add("bg-[#F0C39F]", "text-[#8B4513]", "font-bold", "rounded-full", "selected");
          }

          // Tambahkan event listener untuk interaksi
          dayEl.addEventListener("click", function () {
            document
              .querySelectorAll("#calendar-grid-container > span")
              .forEach((d) => d.classList.remove("bg-[#F0C39F]", "text-[#8B4513]", "font-bold", "rounded-full", "selected"));
            
            // Menerapkan kelas SELECTED dengan Tailwind
            this.classList.add("bg-[#F0C39F]", "text-[#8B4513]", "font-bold", "rounded-full", "selected");
            const clickedDate = this.dataset.date;
            updateChartByDate(clickedDate);
          });

          calendarGridContainer.appendChild(dayEl);
        }
      }

      /**
       * Fungsi untuk mensimulasikan pembaruan grafik berdasarkan tanggal
       */
      function updateChartByDate(dateString) {
        console.log(`Memuat data untuk tanggal: ${dateString}`);

        const seed = new Date(dateString).getDate();
        // Data penjualan disimulasikan agar bervariasi
        const newChartData = Array(7)
          .fill(0)
          .map(
            (_, i) => Math.floor(Math.random() * 20) + 30 + seed * 0.5 + i * 2
          );

        // Perbarui data dan label info
        penjualanChart.data.datasets[0].data = newChartData;
        penjualanChart.update();
        chartInfoEl.textContent = `Data Penjualan Mingguan sekitar ${dateString}`;
      }

      // ... (Fungsi fetchRealtimeData dan Eksekusi Awal tidak diubah) ...
      
      // ========================================================
      // FUNGSI REAL-TIME STATISTIK BAWAH
      // ========================================================
      const visitorsCountEl = document.getElementById("visitors-count");
      const productsCountEl = document.getElementById("products-count");
      const likesCountEl = document.getElementById("likes-count");
      const soldCountEl = document.getElementById("sold-count");

      function fetchRealtimeData() {
        // --- SIMULASI DATA BARU ---
        const newData = {
          visitors: Math.floor(Math.random() * 500) + 500,
          products: 15,
          likes: Math.floor(Math.random() * 300) + 700,
          sold: Math.floor(Math.random() * 500) + 1000,
        };

        // --- MEMPERBARUI TAMPILAN (DOM) ---
        visitorsCountEl.textContent = newData.visitors.toLocaleString();
        productsCountEl.textContent = newData.products.toLocaleString();
        likesCountEl.textContent = newData.likes.toLocaleString();
        soldCountEl.textContent = newData.sold.toLocaleString();
      }

      // ========================================================
      // EKSEKUSI AWAL
      // ========================================================

      // 1. Inisialisasi Kalender
      generateCalendar(currentYear, currentMonth);

      // 2. Inisialisasi Grafik (dengan data hari ini)
      updateChartByDate(
        `${currentYear}-${currentMonth + 1}-${today.getDate()}`
      );

      // 3. Atur pembaruan real-time untuk statistik (setiap 10 detik)
      fetchRealtimeData();
      const updateInterval = 10000;
      setInterval(fetchRealtimeData, updateInterval);

      // Optional: Atur ulang ukuran grafik saat jendela diubah ukurannya
      window.addEventListener("resize", () => penjualanChart.resize());
    </script>
  </body>
</html>